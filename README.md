# PowerApps
This project was created to assist with the mass movement of Power Platform solutions 
from one environment, like the default environment, into one more other environments,
like user environments.
This code mimics the code created by Suparna Banerjee which can be found at:
https://suparnatechbasket.wordpress.com/2023/07/26/bulk-move-dataverse-solutions/

The idea behind these scripts in comparison to those provided by Suparna is for cases
where you want to take one or more solutions out of the default environment and 
distribute them to various user environments. 

This script uses the Power Platform CLI and therefore has the same requirements  
Suparna states in her document:
* Power Platform Tools for Visual Studio Code
  (if you will be editing/running this in Visual Studio)
  https://learn.microsoft.com/en-us/power-platform/developer/cli/introduction#install-using-power-platform-tools-for-visual-studio-code
* Power Platform CLI for Windows
  https://learn.microsoft.com/en-us/power-platform/developer/cli/introduction#install-power-platform-cli-for-windows
Because of the -AsPlainText parameter on the ConvertFrom-SecureString cmdlet, 
these scripts require PowerShell 7.0 as that parameter is not available until PS 7.0.

1/5/2024 - I still feel there is much to be added to these scripts but because
of perceived demand for these scripts, they are being published as is preliminarily.

After downloading the two scripts Export-Solutions.ps1 and Import-Solutions.ps1:
* Step 1: Modify the Export script to run against your default environment to export
  all of the unmanaged solutions in that environment except the default solution and
  the CDS default solution.
* Step 2: Execute the Export script.
* Step 3: Modify the Export.csv file that the Export script created.
  The CSV file specifies all of the unmanaged solutions found and gives the admin a
  column named DestinationEnvironment which specifies the target environment for a
  given solution.
  You can delete any rows for solutions you don't want imported.
* Step 4: Modify the Import script to identify the folder containing the  .CSV, .zip,
  and .json files.
* Step 5: Run the Import script and let it import your solutions into the target
  environments.
* Step 6: Look in the $defaultLocation to see if the Import script  generated an
  exceptions.csv file. This file will contain any issues that were encountered during
  the imports.

--------------------
EXPORT-SOLUTIONS.PS1
--------------------

There are two variables at the top of the script which must be edited. 
* $defaultLocation - specifies the folder where the solutions will be exported
* $sourceEnv       - specifies the full URL of the source/default environment

The script will list all solutions in your default environment using the pac command
pac solution list
The script filters out any managed solutions as well as the Default and CDS solution.
It then iterates through all of the unmanaged solutions it found and exports them to 
your $defaultLocation.
The script will also generate an Exports.CSV file which contains a row for each
solution exported. Each row contains the following columns:
* UniqueName             - The UniqueName returned for the solution from the pac solutions
                           list command
* FriendlyName           - The FriendlyName field value returned
* Version                - The Version field value returned
* Managed                - The Managed field value returned. Should always be False
* ZipSavedLocation       - The path and filename of the .zip file generated for the
                           solution
* JSONSavedLocation      - The path and filename of the .json file generated
* DestinationEnvironment - This field will be blank.
                           The admin uses this field to specify the destination environment
                           for the solution.

--------------------
IMPORT-SOLUTIONS.PS1
--------------------

There is one variable at the top of the script which must be edited.
* defaultLocation - should contain the same value as this variable in the Export script

The script will:
* Import the Exports.csv file generated by the Export script and edited by the admin.
* Get a list of unique destination environments. This will ensure that the script isn't
  having to reconnect repeatedly to environments which are specified more than once
* Iterate through the list of unique destination environments one by one
* For each destination environment, it import the source solutions one by one
* For any solutions where either the .zip or .json file are not found, the script will not
  import the solution and add a row for that solution to the exceptions.csv file.
* For any solutions which encounter an error during import, a row for that solution will
  be added to the exceptions.csv file
* Any solutions to import which have a version which matches the version number of a
  solution by the same name in the destination environment, the script will not import that
  solution. This is what we found occurs when using the   pac solution import command.
